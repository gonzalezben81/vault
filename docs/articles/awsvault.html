<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="vault">
<title>AWS &amp; Vault â€¢ vault</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="AWS &amp; Vault">
<meta property="og:description" content="vault">
<meta property="og:image" content="https://gonzalezben81.github.io/vault/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><script defer data-domain="pkgdown.r-lib.org,all.tidyverse.org" src="https://plausible.io/js/plausible.js"></script><!-- Google tag (gtag.js) --><script async src="https://www.googletagmanager.com/gtag/js?id=G-S6MW51TT6K"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-S6MW51TT6K');
</script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">vault</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/vault.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/awscftemplates.html">AWS &amp; Vault CloudFormation Templates</a>
    <a class="dropdown-item" href="../articles/awsvault.html">AWS &amp; Vault</a>
    <a class="dropdown-item" href="../articles/azurevault.html">Azure &amp; Vault</a>
    <a class="dropdown-item" href="../articles/github.html">GitHub &amp; Vault</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/gonzalezben81/vault/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>AWS &amp; Vault</h1>
                        <h4 data-toc-skip class="author">Ben
Gonzalez</h4>
            
            <h4 data-toc-skip class="date">2024-07-07</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/gonzalezben81/vault/blob/HEAD/vignettes/awsvault.Rmd" class="external-link"><code>vignettes/awsvault.Rmd</code></a></small>
      <div class="d-none name"><code>awsvault.Rmd</code></div>
    </div>

    
    
<div class="section level4">
<h4 id="creates-aws-resources">Creates AWS Resources<a class="anchor" aria-label="anchor" href="#creates-aws-resources"></a>
</h4>
<p>Before you configure the HCP Vault AWS auth method, you must create
the necessary resources in AWS. The AWS auth method will require an IAM
policy that permits the appropriate access for the auth method, an IAM
user with programmatic access, and one or more roles that you will
assign to other AWS services that require authentication to Vault.</p>
</div>
<div class="section level4">
<h4 id="create-the-iam-policy-for-your-iam-user">Create the IAM Policy for your IAM User<a class="anchor" aria-label="anchor" href="#create-the-iam-policy-for-your-iam-user"></a>
</h4>
<p>The below policy needs to be attached to the IAM User you are
creating in AWS.</p>
<p><strong>Note: You may need to add more IAM permissions if you receive
errors authenticating</strong></p>
<div class="sourceCode" id="cb1"><pre class="sourceCode json"><code class="sourceCode json"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">{</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>    <span class="dt">"Version"</span><span class="fu">:</span> <span class="st">"2012-10-17"</span><span class="fu">,</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>    <span class="dt">"Statement"</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>        <span class="fu">{</span></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>            <span class="dt">"Effect"</span><span class="fu">:</span> <span class="st">"Allow"</span><span class="fu">,</span></span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a>            <span class="dt">"Action"</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a>                <span class="st">"ec2:DescribeInstances"</span><span class="ot">,</span></span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a>                <span class="st">"iam:GetInstanceProfile"</span><span class="ot">,</span></span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a>                <span class="st">"iam:GetUser"</span><span class="ot">,</span></span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a>                <span class="st">"iam:ListRoles"</span><span class="ot">,</span></span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a>                <span class="st">"iam:GetRole"</span><span class="ot">,</span></span>
<span id="cb1-12"><a href="#cb1-12" tabindex="-1"></a>                <span class="st">"iam:CreateUser"</span><span class="ot">,</span></span>
<span id="cb1-13"><a href="#cb1-13" tabindex="-1"></a>                <span class="st">"iam:PutUserPolicy"</span></span>
<span id="cb1-14"><a href="#cb1-14" tabindex="-1"></a>            <span class="ot">]</span><span class="fu">,</span></span>
<span id="cb1-15"><a href="#cb1-15" tabindex="-1"></a>            <span class="dt">"Resource"</span><span class="fu">:</span> <span class="st">"*"</span></span>
<span id="cb1-16"><a href="#cb1-16" tabindex="-1"></a>        <span class="fu">}</span></span>
<span id="cb1-17"><a href="#cb1-17" tabindex="-1"></a>    <span class="ot">]</span></span>
<span id="cb1-18"><a href="#cb1-18" tabindex="-1"></a><span class="fu">}</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="create-iam-policy-for-your-iam-role">Create IAM Policy for your IAM Role<a class="anchor" aria-label="anchor" href="#create-iam-policy-for-your-iam-role"></a>
</h4>
<p>You will now create the IAM policy for your IAM Role. You will need
to attach this to your IAM Role to allow Vault to connect to it and
authenticate. You can replace <em>vaultauth</em> with the name of the
IAM Role and IAM User that you have created.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode json"><code class="sourceCode json"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">{</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>    <span class="dt">"Version"</span><span class="fu">:</span> <span class="st">"2012-10-17"</span><span class="fu">,</span></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>    <span class="dt">"Statement"</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>        <span class="fu">{</span></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a>            <span class="dt">"Effect"</span><span class="fu">:</span> <span class="st">"Allow"</span><span class="fu">,</span></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a>            <span class="dt">"Action"</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a>                <span class="st">"ec2:DescribeInstances"</span><span class="ot">,</span></span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a>                <span class="st">"iam:GetInstanceProfile"</span><span class="ot">,</span></span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a>                <span class="st">"iam:GetUser"</span><span class="ot">,</span></span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a>                <span class="st">"iam:GetRole"</span></span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a>            <span class="ot">]</span><span class="fu">,</span></span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a>            <span class="dt">"Resource"</span><span class="fu">:</span> <span class="st">"*"</span></span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a>        <span class="fu">}</span><span class="ot">,</span></span>
<span id="cb2-14"><a href="#cb2-14" tabindex="-1"></a>        <span class="fu">{</span></span>
<span id="cb2-15"><a href="#cb2-15" tabindex="-1"></a>            <span class="dt">"Effect"</span><span class="fu">:</span> <span class="st">"Allow"</span><span class="fu">,</span></span>
<span id="cb2-16"><a href="#cb2-16" tabindex="-1"></a>            <span class="dt">"Action"</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb2-17"><a href="#cb2-17" tabindex="-1"></a>                <span class="st">"sts:AssumeRole"</span></span>
<span id="cb2-18"><a href="#cb2-18" tabindex="-1"></a>            <span class="ot">]</span><span class="fu">,</span></span>
<span id="cb2-19"><a href="#cb2-19" tabindex="-1"></a>            <span class="dt">"Resource"</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb2-20"><a href="#cb2-20" tabindex="-1"></a>                <span class="st">"arn:aws:iam::&lt;aws-account-number&gt;:role/vaultauth"</span></span>
<span id="cb2-21"><a href="#cb2-21" tabindex="-1"></a>            <span class="ot">]</span></span>
<span id="cb2-22"><a href="#cb2-22" tabindex="-1"></a>        <span class="fu">}</span><span class="ot">,</span></span>
<span id="cb2-23"><a href="#cb2-23" tabindex="-1"></a>        <span class="fu">{</span></span>
<span id="cb2-24"><a href="#cb2-24" tabindex="-1"></a>            <span class="dt">"Sid"</span><span class="fu">:</span> <span class="st">"ManageOwnAccessKeys"</span><span class="fu">,</span></span>
<span id="cb2-25"><a href="#cb2-25" tabindex="-1"></a>            <span class="dt">"Effect"</span><span class="fu">:</span> <span class="st">"Allow"</span><span class="fu">,</span></span>
<span id="cb2-26"><a href="#cb2-26" tabindex="-1"></a>            <span class="dt">"Action"</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb2-27"><a href="#cb2-27" tabindex="-1"></a>                <span class="st">"iam:CreateAccessKey"</span><span class="ot">,</span></span>
<span id="cb2-28"><a href="#cb2-28" tabindex="-1"></a>                <span class="st">"iam:DeleteAccessKey"</span><span class="ot">,</span></span>
<span id="cb2-29"><a href="#cb2-29" tabindex="-1"></a>                <span class="st">"iam:GetAccessKeyLastUsed"</span><span class="ot">,</span></span>
<span id="cb2-30"><a href="#cb2-30" tabindex="-1"></a>                <span class="st">"iam:GetUser"</span><span class="ot">,</span></span>
<span id="cb2-31"><a href="#cb2-31" tabindex="-1"></a>                <span class="st">"iam:ListAccessKeys"</span><span class="ot">,</span></span>
<span id="cb2-32"><a href="#cb2-32" tabindex="-1"></a>                <span class="st">"iam:UpdateAccessKey"</span></span>
<span id="cb2-33"><a href="#cb2-33" tabindex="-1"></a>            <span class="ot">]</span><span class="fu">,</span></span>
<span id="cb2-34"><a href="#cb2-34" tabindex="-1"></a>            <span class="dt">"Resource"</span><span class="fu">:</span> <span class="st">"arn:aws:iam::*:user/vaultauth"</span></span>
<span id="cb2-35"><a href="#cb2-35" tabindex="-1"></a>        <span class="fu">}</span></span>
<span id="cb2-36"><a href="#cb2-36" tabindex="-1"></a>    <span class="ot">]</span></span>
<span id="cb2-37"><a href="#cb2-37" tabindex="-1"></a><span class="fu">}</span></span>
<span id="cb2-38"><a href="#cb2-38" tabindex="-1"></a></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="create-the-connections-to-vault-via-aws-iam-user-and-aws-iam-role">Create the connections to Vault via AWS IAM User and AWS IAM
Role<a class="anchor" aria-label="anchor" href="#create-the-connections-to-vault-via-aws-iam-user-and-aws-iam-role"></a>
</h4>
<p>Enable aws auth on your vault instance.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="ex">vault</span> auth enable aws</span></code></pre></div>
<p>Check to see if the vault auth aws method has been enabled.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="ex">vault</span> auth list</span></code></pre></div>
<p>Next connect the IAM role you created in AWS to the Vault aws auth
backend. This will configure the AWS auth method with access to your AWS
account using the Access key ID and Secret Access Key previously created
for the IAM User you created in AWS.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="ex">vault</span> write auth/aws/config/client secret_key=<span class="op">&lt;</span>secret-key<span class="op">&gt;</span> access_key=<span class="op">&lt;</span>access-key<span class="op">&gt;</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="create-vault-role-for-connection-to-aws-iam-role">Create Vault role for connection to AWS IAM Role<a class="anchor" aria-label="anchor" href="#create-vault-role-for-connection-to-aws-iam-role"></a>
</h4>
<p>Configure the AWS auth method to trust the AWS IAM role previously
created and attach the vault-policy-for-aws-ec2role to the token
provided by the AWS auth method. Replace <iam-arn> with the actual IAM
Role ARN you created in AWS.</iam-arn></p>
<p><strong>Note: The IAM User Arn will look like the following:
arn:aws:iam::&lt;aws-account-number&gt;:user/vaultauth </strong></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="ex">vault</span> write auth/aws/role/vaultauth <span class="dt">\</span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>     auth_type=iam <span class="dt">\</span></span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>     bound_iam_principal_arn=arn:aws:iam::<span class="op">&lt;</span>aws-account-number<span class="op">&gt;</span>:role/vaultauth <span class="dt">\</span></span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>     policies=default,allinone</span></code></pre></div>
<p>List the roles you created for the aws auth method.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="ex">vault</span> list /auth/aws/role</span></code></pre></div>
</div>
<div class="section level4">
<h4 id="setup-authentication-to-vault-via-an-iam-role">Setup authentication to Vault via an IAM Role<a class="anchor" aria-label="anchor" href="#setup-authentication-to-vault-via-an-iam-role"></a>
</h4>
<ul>
<li>auth/aws/role/<name-of-vault-iam-role> - this is the name of the
role you are creating in vault</name-of-vault-iam-role>
</li>
<li>auth_type=iam - this notes that vault will authenticate via an IAM
role</li>
<li>bound_iam_principal_arn - this is the IAM Role arn that you will get
from your AWS account</li>
<li>policies - these are the policy(s) you will associate with your
vault role</li>
</ul>
<div class="sourceCode" id="cb8"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="ex">vault</span> write auth/aws/role/vaultauth auth_type=iam <span class="dt">\</span></span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>              bound_iam_principal_arn=<span class="op">&lt;</span>iam-arn<span class="op">&gt;</span> policies=default,allinonepolicy max_ttl=500h</span></code></pre></div>
</div>
<div class="section level4">
<h4 id="setup-authentication-to-vault-via-an-iam-role-or-an-ec2-auth-method">Setup authentication to Vault via an IAM Role or an ec2 Auth
Method<a class="anchor" aria-label="anchor" href="#setup-authentication-to-vault-via-an-iam-role-or-an-ec2-auth-method"></a>
</h4>
<div class="sourceCode" id="cb9"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="co">###Vault role that will authenticate via the ec2 auth method</span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a><span class="ex">vault</span> write auth/aws/role/vaultauth auth_type=ec2 bound_ami_id=ami-fce3c696 policies=prod,dev max_ttl=500h</span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="co">###Create Vault role that allows an IAM role to authenticate with it</span></span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a><span class="ex">vault</span> write auth/aws/role/vaultauth auth_type=iam <span class="dt">\</span></span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>              bound_iam_principal_arn=arn:aws:iam::<span class="op">&lt;</span>aws-account-number<span class="op">&gt;</span>:role/test-iam-vault-auth policies=allinone,dev max_ttl=500</span></code></pre></div>
</div>
<div class="section level4">
<h4 id="test-your-login-from-an-ec2-instance">Test your login from an ec2 instance<a class="anchor" aria-label="anchor" href="#test-your-login-from-an-ec2-instance"></a>
</h4>
<div class="sourceCode" id="cb11"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="ex">vault</span> login <span class="at">-method</span><span class="op">=</span>aws region=us-east-1 role=vaultauthentication</span></code></pre></div>
</div>
<div class="section level4">
<h4 id="test-listing-secrets">Test listing secrets<a class="anchor" aria-label="anchor" href="#test-listing-secrets"></a>
</h4>
<div class="sourceCode" id="cb12"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="ex">vault</span> kv get <span class="at">-mount</span><span class="op">=</span>secret <span class="op">&lt;</span>secret-path<span class="op">&gt;</span></span></code></pre></div>
<center>
References
</center>
<p><a href="https://developer.hashicorp.com/vault/docs/v1.16.x/auth/aws#authentication" class="external-link">Vault
Auth Method</a></p>
<p><a href="https://developer.hashicorp.com/vault/docs/v1.16.x/auth/aws#comparison-of-the-iam-and-ec2-methods" class="external-link">IAM
and ec2 Auth Methods</a></p>
<p><a href="https://developer.hashicorp.com/vault/api-docs/v1.16.x/auth/aws#aws-auth-method-api" class="external-link">Vault
AWS Auth Method API</a></p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://rgonzo.com" class="external-link">Ben Gonzalez</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
